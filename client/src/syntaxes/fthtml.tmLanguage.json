{"$schema":"https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json","name":"fthtml","scopeName":"source.fthtml","patterns":[{"include":"#top-level-elements"},{"include":"#entity-errors"}],"repository":{"top-level-elements":{"patterns":[{"include":"#strings"},{"include":"#comments"},{"include":"#directives"},{"include":"#template"},{"include":"#keywords"},{"include":"#variables-ref"},{"include":"#embedded-langs"},{"include":"#fthtmlblock"},{"include":"#parent-entity"}]},"fthtmlblock":{"patterns":[{"begin":"\\{","beginCaptures":{"0":{"name":"punctuation.definition.tag.begin.fthtml"}},"end":"\\}","endCaptures":{"0":{"name":"punctuation.definition.tag.end.fthtml"}},"patterns":[{"include":"#strings"},{"include":"#comments"},{"include":"#template"},{"include":"#keywords"},{"include":"#variables-ref"},{"include":"#embedded-langs"},{"include":"#parent-entity"},{"include":"$self"}]}]},"parent-entity":{"patterns":[{"include":"#entity-tag-attr"},{"match":"\\b([\\w-]+)\\b","captures":{"1":{"name":"entity.name.tag.fthtml"}}}]},"binding-property":{"patterns":[{"match":"^\\s*__(UUID|JS_AGENT|JS_URI|JS_URI_HASH|JS_URI_HOSTNAME|JS_URI_HOST|JS_URI_PORT|JS_URI_PATH|JS_URI_PROTOCOL|JS_URI_SEARCH|((?:JS_)?(?:DATE|DATETIME|ISO_DATE|LOCAL_DATE|LOCAL_DATETIME|NOW)))__.*","name":"invalid.illegal.fthtml"},{"match":"^\\s*(addslashes|choose|html_encode|html_decode|random|replace|str_repeat|str_reverse|str_format|substring|tcase|trim).*","name":"invalid.illegal.fthtml"},{"include":"#variables-ref"},{"include":"#macros"},{"include":"#functions"},{"include":"#comments"},{"match":"^\\s*([\\w-]+)(?=\\s*(['\"])[^\\2]*?\\2\\s*(?:\\/\\/.*)?$)","captures":{"1":{"name":"variable.other.readwrite.fthtml"}}},{"match":"^\\s*([\\w-]+)(?=\\s+@[\\w-]+\\s*(?:\\/\\/.*)?$)","captures":{"1":{"name":"variable.other.readwrite.fthtml"}}},{"match":"^\\s*([\\w-]+)\\s+(?=__(UUID|JS_AGENT|JS_URI|JS_URI_HASH|JS_URI_HOSTNAME|JS_URI_HOST|JS_URI_PORT|JS_URI_PATH|JS_URI_PROTOCOL|JS_URI_SEARCH|((?:JS_)?(?:DATE|DATETIME|ISO_DATE|LOCAL_DATE|LOCAL_DATETIME|NOW)))__)","captures":{"1":{"name":"variable.other.readwrite.fthtml"}}},{"match":"^\\s*([\\w-]+)\\s+(?=(addslashes|choose|html_encode|html_decode|random|replace|str_repeat|str_reverse|str_format|substring|tcase|trim)\\([^\\)]*\\))","captures":{"1":{"name":"variable.other.readwrite.fthtml"}}},{"begin":"^\\s*([\\w-]+)\\s+(?!json)","beginCaptures":{"1":{"name":"variable.other.readwrite.fthtml"}},"end":"(?<=\\})","patterns":[{"include":"#fthtmlblock"}]}]},"template":{"patterns":[{"begin":"^\\s*(import)\\s+((['\"]).*?\\3)\\s+(?=\\{)","beginCaptures":{"1":{"name":"keyword.other.$1.fthtml"},"2":{"name":"string.quoted.fthtml"}},"end":"(?<=\\})","patterns":[{"begin":"\\{","beginCaptures":{"0":{"name":"punctuation.definition.tag.begin.fthtml"}},"end":"\\}","endCaptures":{"0":{"name":"punctuation.definition.tag.end.fthtml"}},"patterns":[{"include":"#strings"},{"include":"#comments"},{"match":"(?x)  (?:\n    ^\\s*(comment|doctype|import) #not allowed here\n  )\n  (?=\\s+(['\"]).*?\\2|(.*)) #end should be string for keywords, this checks both single and double quoted","captures":{"1":{"name":"invalid.illegal.keyword.$1.fthtml"},"3":{"name":"invalid.illegal.keyword-value.fthtml"}}},{"include":"#binding-property"},{"name":"invalid.illegal.variable-value.fthtml","match":"([^'\"])"}]}]}]},"directives":{"patterns":[{"begin":"^[ \\t]*(#)[ \\t]*(vars)(?:$|(.*))","beginCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"end":"^[ \\t]*(#)[ \\t]*(end)(?:$|(.*))","endCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.end.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"patterns":[{"include":"#comments"},{"include":"#strings"},{"include":"#binding-property"},{"match":"^\\s*([\\w-]+)\\s+(json)\\s*(\\()\\s*((['\"])[^\\5]*\\5)\\s*(\\))\\s*$","captures":{"1":{"name":"variable.other.readwrite.fthtml"},"2":{"name":"meta.function.fthtml meta.function.$2.fthtml entity.name.function.fthtml"},"3":{"name":"meta.parameters.fthtml punctuation.definition.parameters.begin.fthtml"},"4":{"name":"string.quoted.fthtml"},"6":{"name":"meta.parameters.fthtml punctuation.definition.parameters.end.fthtml"}}},{"name":"invalid.illegal.variable-value.fthtml","match":"([^'\"\\}])"}]}]},"keywords":{"patterns":[{"include":"#functions"},{"include":"#macros"},{"match":"(?x)  (?:\n    (?:^|[ \\t]+?) #check if starts at new line or n spaces from new line\n    (comment|import) #these keywords can be anywhere in syntax and must be followed by a string\n    | ^[\\s]*(doctype) #doctype can NOT be anywhere but beginning of line\n  )\n  (?=\\s+(['\"]).*?\\3|(.*)) #end should be string for keywords, this checks both single and double quoted","captures":{"1":{"name":"keyword.other.$1.fthtml"},"2":{"name":"keyword.other.$2.fthtml"},"3":{"name":"keyword.other.$3.fthtml"},"4":{"name":"invalid.illegal.keyword-value.fthtml"}}}]},"functions":{"patterns":[{"begin":"(addslashes|choose|html_encode|html_decode|random|replace|str_repeat|str_reverse|str_format|substring|tcase|trim)(\\()","beginCaptures":{"1":{"name":"support.function.fthtml meta.function.fthtml meta.function.$1.fthtml entity.name.function.fthtml"},"2":{"name":"meta.parameters.fthtml punctuation.definition.parameters.begin.fthtml"}},"end":"\\)","endCaptures":{"0":{"name":"meta.parameters.fthtml punctuation.definition.parameters.end.fthtml"}},"patterns":[{"include":"#strings"},{"include":"#variables-ref"},{"include":"#macros"},{"include":"#functions"},{"begin":"(?<=\\s|\\()","end":"(?=\\s|\\))","patterns":[{"match":"\\d+","captures":{"0":{"name":"meta.argument.numeric.fthtml constant.numeric.fthtml"}}},{"match":"[\\w-]+","captures":{"0":{"name":"meta.argument.word.fthtml variable.other.constant.fthtml"}}}]}]}]},"macros":{"patterns":[{"match":"\\b__(UUID|JS_AGENT|JS_URI|JS_URI_HASH|JS_URI_HOSTNAME|JS_URI_HOST|JS_URI_PORT|JS_URI_PATH|JS_URI_PROTOCOL|JS_URI_SEARCH)__\\b","captures":{"0":{"name":"meta.macro.fthtml constant.language.__$1__.fthtml"}}},{"match":"\\b__((?:JS_)?(?:DATE|DATETIME|ISO_DATE|LOCAL_DATE|LOCAL_DATETIME|NOW))__\\b","captures":{"0":{"name":" meta.macro.fthtml constant.language.__$1__.fthtml"}}}]},"strings":{"name":"string.quoted.fthtml","patterns":[{"name":"string.quoted.double.fthtml","begin":"\"","beginCaptures":{"0":{"name":"punctuation.definition.string.begin.fthtml"}},"end":"\"","endCaptures":{"1":{"name":"punctuation.definition.string.end.fthtml"},"2":{"name":"invalid.illegal.newline.fthtml"}},"patterns":[{"include":"#string-character-escape"},{"include":"#string-template-expression"}]},{"name":"string.quoted.single.fthtml","begin":"'","beginCaptures":{"0":{"name":"punctuation.definition.string.begin.fthtml"}},"end":"'","endCaptures":{"1":{"name":"punctuation.definition.string.end.fthtml"},"2":{"name":"invalid.illegal.newline.fthtml"}},"patterns":[{"include":"#string-character-escape"},{"include":"#string-template-expression"}]}]},"string-character-escape":{"patterns":[{"name":"constant.character.escape.fthtml","match":"\\\\(?!\\$)(x[0-9A-Fa-f]{2}|[0-2][0-7]{0,1}|3[0-6][0-7]?|37[0-7]?|[4-7][0-7]?|['\"]|$)"}]},"string-template-expression":{"patterns":[{"match":"(?x)  (?<!\\\\) #not escaped\n  (\\${)[ ]*\n    (\n      (@)[\\w-]+\n      (?:\n        (?:\\[\\d+\\])*(?:\\.[a-zA-Z0-9][a-zA-Z0-9-_]*(?:\\[\\d+\\])*)+\n        |(?:\\[\\d+\\])+\n      )+\n    )\n    [ ]*(})","captures":{"0":{"name":"meta.template.expression.fthtml"},"1":{"name":"punctuation.definition.template-expression.begin.fthtml"},"2":{"name":"variable.other.fthtml"},"3":{"name":"punctuation.definition.variable.other.begin.fthtml"},"4":{"name":"punctuation.definition.template-expression.end.fthtml"}}},{"match":"(?<!\\\\)(\\${)[ ]*(([@]?)[\\w-]+\\??)[ ]*(})","captures":{"0":{"name":"meta.template.expression.fthtml"},"1":{"name":"punctuation.definition.template-expression.begin.fthtml"},"2":{"name":"variable.other.fthtml"},"3":{"name":"punctuation.definition.variable.other.begin.fthtml"},"4":{"name":"punctuation.definition.template-expression.end.fthtml"}}}]},"comments":{"name":"comment.fthtml","patterns":[{"name":"comment.line.fthtml","begin":"(^[ \\t]+)?((//)(?:\\s*(?=\\s|$))?)","beginCaptures":{"3":{"name":"punctuation.definition.comment.line.begin.fthtml"}},"end":"(?=$|^)"},{"name":"comment.block.fthtml","begin":"(/\\*)(?:\\s*(?=\\s|(\\*/)))?","beginCaptures":{"1":{"name":"punctuation.definition.comment.block.begin.fthtml"}},"end":"\\*/","endCaptures":{"0":{"name":"punctuation.definition.comment.block.end.fthtml"}}}]},"variables-ref":{"patterns":[{"match":"(@)[\\w-]+","captures":{"0":{"name":"variable.other.fthtml"},"2":{"name":"punctuation.definition.variable.other.begin.fthtml"}}}]},"entity-tag-attr":{"patterns":[{"begin":"(?x)  (?:^|\\s) #start of string\n  (?!addslashes|choose|html_encode|html_decode|random|replace|str_repeat|str_reverse|str_format|substring|tcase|trim)([\\w-]+)\\s* #valid identifier\n  (/\\*(?:\\s*(?=\\s|(?:\\*/)))?.*?\\*/)* #can have n block comments after the identifier\n  \\s*(\\() #begin with '(' open","beginCaptures":{"1":{"name":"entity.name.tag.fthtml"},"2":{"patterns":[{"include":"#comments"}]},"3":{"name":"punctuation.definition.entity.other.attribute-group.begin.fthtml"}},"end":"(?=(\\)))","endCaptures":{"1":{"name":"punctuation.definition.entity.other.attribute-group.end.fthtml"}},"patterns":[{"include":"#macros"},{"include":"#strings"},{"name":"entity.other.attribute-name.class.fthtml","begin":"\\B(\\.)(?=@?[\\w-]+|(.*))","beginCaptures":{"1":{"name":"punctuation.entity.other.attribute-name.class.begin.fthtml"},"2":{"name":"invalid.illegal.attribute.class.fthtml"}},"end":"(@?[\\w-]+)(?:\\s|(?=\\))|(.*))","endCaptures":{"1":{"patterns":[{"include":"#variables-ref"}]},"2":{"name":"invalid.illegal.attribute.class.fthtml"}}},{"name":"entity.other.attribute-name.id.fthtml","begin":"\\B(\\#)(?=[\\w-]+|(.*))","beginCaptures":{"1":{"name":"punctuation.entity.other.attribute-name.id.begin.fthtml"},"2":{"name":"invalid.illegal.attribute.id.fthtml"}},"end":"(@?[\\w-]+)(?:\\s|(?=\\))|(.*))","endCaptures":{"1":{"patterns":[{"include":"#variables-ref"}]},"2":{"name":"invalid.illegal.attribute.id.fthtml"}}},{"include":"#variables-ref"},{"begin":"([\\w-]+)\\s*(=)\\s*","beginCaptures":{"1":{"name":"entity.other.attribute-name.fthtml"},"2":{"name":"punctuation.separator.key-value.fthtml"}},"end":"\\s|(?=\\))","patterns":[{"include":"#strings"},{"include":"#variables-ref"},{"include":"#macros"},{"name":"string.unquoted.fthtml","match":"(?x) \\s*?([\\w-]+[\\w\\.-]*) #this makes sure that unquoted values are valid with many periods (ex: www.example.com) ([^\\s\\)]*) #followed by anything that doesn't terminate the attribute group because we do it in parent regex end","captures":{"2":{"name":"invalid.illegal.attribute.value.fthtml"}}},{"name":"invalid.illegal.attribute.value.fthtml","match":"\\s*?(?!\\))([\\W].*)"}]},{"name":"entity.other.attribute-name.fthtml","match":"(?:[\\w-]+)"},{"name":"invalid.illegal.fthtml","match":"(?:[\\W])"}]}]},"entity-errors":{"patterns":[{"name":"invalid.illegal.identifier.fthtml","match":"([^\\@\\#\\.\\(\\)\\{\\}\\=])"}]},"entity-parenthesis":{"patterns":[{"begin":"\\{","end":"\\}","patterns":[{"include":"#entity-parenthesis"}]}]},"embedded-langs":{"patterns":[{"begin":"(?:^|\\s)(js)\\s+","beginCaptures":{"1":{"name":"entity.name.tag.fthtml"}},"end":"(?<=\\})","patterns":[{"begin":"\\{","beginCaptures":{"0":{"name":"punctuation.definition.tag.begin.fthtml"}},"end":"\\}","endCaptures":{"0":{"name":"punctuation.definition.tag.end.fthtml"}},"contentName":"meta.embedded.block.js","patterns":[{"include":"source.js"},{"include":"#entity-parenthesis"}]}]},{"begin":"(?:^|\\s)(css)\\s+","beginCaptures":{"1":{"name":"entity.name.tag.fthtml"}},"end":"(?<=\\})","patterns":[{"begin":"\\{","beginCaptures":{"0":{"name":"punctuation.definition.tag.begin.fthtml"}},"end":"\\}","endCaptures":{"0":{"name":"punctuation.definition.tag.end.fthtml"}},"contentName":"meta.embedded.block.css","patterns":[{"include":"source.css"},{"include":"#entity-parenthesis"}]}]}]}}}
