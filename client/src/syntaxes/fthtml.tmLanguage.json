{"$schema":"https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json","name":"fthtml","scopeName":"source.fthtml","patterns":[{"include":"#top-level-elements"}],"repository":{"top-level-elements":{"patterns":[{"include":"#comments"},{"include":"#variables-ref"},{"include":"#directives"},{"include":"#keywords"},{"include":"#entities"},{"include":"#fthtmlblock"}]},"child-elements":{"patterns":[{"include":"#strings"},{"include":"#top-level-elements"}]},"fthtmlblock":{"patterns":[{"include":"#comments"},{"begin":"\\{","beginCaptures":{"0":{"name":"punctuation.definition.tag.begin.fthtml"}},"end":"\\}","endCaptures":{"0":{"name":"punctuation.definition.tag.end.fthtml"}},"patterns":[{"include":"#child-elements"},{"include":"#fthtmlblock"}]}]},"strings":{"name":"string.quoted.fthtml","patterns":[{"name":"string.quoted.double.fthtml","begin":"\"","beginCaptures":{"0":{"name":"punctuation.definition.string.begin.fthtml"}},"end":"\"","endCaptures":{"1":{"name":"punctuation.definition.string.end.fthtml"},"2":{"name":"invalid.illegal.newline.fthtml"}},"patterns":[{"include":"#string-character-escape"},{"include":"#string-template-expression"}]},{"name":"string.quoted.single.fthtml","begin":"'","beginCaptures":{"0":{"name":"punctuation.definition.string.begin.fthtml"}},"end":"'","endCaptures":{"1":{"name":"punctuation.definition.string.end.fthtml"},"2":{"name":"invalid.illegal.newline.fthtml"}},"patterns":[{"include":"#string-character-escape"},{"include":"#string-template-expression"}]}]},"string-character-escape":{"patterns":[{"name":"constant.character.escape.fthtml","match":"\\\\(?!\\$)(x[0-9A-Fa-f]{2}|[0-2][0-7]{0,1}|3[0-6][0-7]?|37[0-7]?|[4-7][0-7]?|['\"]|$)"}]},"string-template-expression":{"patterns":[{"match":"(?x)  (?<!\\\\) #not escaped\n  (\\${)[ ]*\n    (\n      (@)[\\w-]+\n      (?:\n        (?:\\[\\d+\\])*(?:\\.[a-zA-Z0-9][a-zA-Z0-9-_]*(?:\\[\\d+\\])*)+\n        |(?:\\[\\d+\\])+\n      )+\n    )\n    [ ]*(})","captures":{"0":{"name":"meta.template.expression.fthtml"},"1":{"name":"punctuation.definition.template-expression.begin.fthtml"},"2":{"name":"variable.other.fthtml"},"3":{"name":"punctuation.definition.variable.other.begin.fthtml"},"4":{"name":"punctuation.definition.template-expression.end.fthtml"}}},{"match":"(?<!\\\\)(\\${)[ ]*(([@]?)[\\w-]+\\??)[ ]*(})","captures":{"0":{"name":"meta.template.expression.fthtml"},"1":{"name":"punctuation.definition.template-expression.begin.fthtml"},"2":{"name":"variable.other.fthtml","patterns":[{"include":"#macros"}]},"3":{"name":"punctuation.definition.variable.other.begin.fthtml"},"4":{"name":"punctuation.definition.template-expression.end.fthtml"}}}]},"string-json":{"name":"string.quoted.fthtml","patterns":[{"name":"string.quoted.double.fthtml","begin":"\"","beginCaptures":{"0":{"name":"punctuation.definition.string.begin.fthtml"}},"end":"\"","endCaptures":{"1":{"name":"punctuation.definition.string.end.fthtml"},"2":{"name":"invalid.illegal.newline.fthtml"}},"patterns":[{"include":"#string-character-escape"},{"include":"#string-template-json-piped-expression"}]},{"name":"string.quoted.single.fthtml","begin":"'","beginCaptures":{"0":{"name":"punctuation.definition.string.begin.fthtml"}},"end":"'","endCaptures":{"1":{"name":"punctuation.definition.string.end.fthtml"},"2":{"name":"invalid.illegal.newline.fthtml"}},"patterns":[{"include":"#string-character-escape"},{"include":"#string-template-json-piped-expression"}]}]},"string-template-json-piped-expression":{"patterns":[{"match":"(?x)  (?<!\\\\) #not escaped\n  (\\${)[ ]*(\n    (@)([\\w-]+)\n    (?:\n      (?:\n        (\n          (\\[\\d+\\])*(?:\\.[a-zA-Z0-9][a-zA-Z0-9-_]*(?:\\[\\d+\\])*)+\n            |(?:\\[\\d+\\])+\n          )+\n        )\n      )?\n      [ ]*(?:(\\|)[ ]*(keys|values)[ ]*)?[ ]*\n      (})\n    )","captures":{"0":{"name":"meta.template.expression.fthtml"},"1":{"name":"punctuation.definition.template-expression.begin.fthtml"},"2":{"name":"variable.other.fthtml"},"3":{"name":"punctuation.definition.variable.other.begin.fthtml"},"7":{"name":"punctuation.other.pipe.fthtml"},"8":{"name":"constant.language.$7.fthtml"},"9":{"name":"punctuation.definition.template-expression.end.fthtml"}}},{"match":"(?<!\\\\)(\\${)[ ]*(([@]?)[\\w-]+\\??)[ ]*(})","captures":{"0":{"name":"meta.template.expression.fthtml"},"1":{"name":"punctuation.definition.template-expression.begin.fthtml"},"2":{"name":"variable.other.fthtml","patterns":[{"include":"#macros"}]},"3":{"name":"punctuation.definition.variable.other.begin.fthtml"},"4":{"name":"punctuation.definition.template-expression.end.fthtml"}}}]},"comments":{"name":"comment.fthtml","patterns":[{"name":"comment.line.fthtml","begin":"(^[ \\t]+)?((//)(?:\\s*(?=\\s|$))?)","beginCaptures":{"3":{"name":"punctuation.definition.comment.line.begin.fthtml"}},"end":"(?=$|^)"},{"name":"comment.block.fthtml","begin":"(/\\*)(?:\\s*(?=\\s|(\\*/)))?","beginCaptures":{"1":{"name":"punctuation.definition.comment.block.begin.fthtml"}},"end":"\\*/","endCaptures":{"0":{"name":"punctuation.definition.comment.block.end.fthtml"}}}]},"binding-property":{"patterns":[{"include":"#fthtmlblock"},{"begin":"^\\s*([\\w-]+)\\s*(?=\\{)","beginCaptures":{"1":{"name":"variable.other.readwrite.fthtml","patterns":[{"include":"#invalid-if-word-any-reserved-word"}]}},"end":"(?<=\\})","patterns":[{"include":"#fthtmlblock"}]},{"begin":"^\\s*([\\w-]+)","beginCaptures":{"1":{"name":"variable.other.readwrite.fthtml","patterns":[{"include":"#invalid-if-word-any-reserved-word"}]}},"end":"$","patterns":[{"include":"#strings"},{"include":"#comments"},{"include":"#macros"},{"include":"#functions"},{"include":"#variables-ref"},{"include":"#invalid-if-word-is-keyword"},{"include":"#invalid-if-word-any-reserved-word"}]}]},"imports":{"patterns":[{"begin":"\\b(import)\\s*((['\"]).*?\\3)\\s*","beginCaptures":{"1":{"name":"keyword.other.$1.fthtml"},"2":{"name":"string.quoted.fthtml"}},"end":"(?=[^\\{])","patterns":[{"begin":"\\{","beginCaptures":{"0":{"name":"punctuation.definition.tag.begin.fthtml"}},"end":"\\}","endCaptures":{"0":{"name":"punctuation.definition.tag.end.fthtml"}},"patterns":[{"include":"#binding-property"}]}]}]},"keywords":{"patterns":[{"include":"#functions"},{"include":"#macros"},{"include":"#imports"},{"match":"(?x)  (?:\n    \\b(comment)\\b #these keywords can be anywhere in syntax and must be followed by a string\n    | ^[\\s]*(doctype) #doctype can NOT be anywhere but beginning of line\n  )\n  (?=\\s+(['\"]).*?\\3|(.*)) #end should be string for keywords, this checks both single and double quoted","captures":{"1":{"name":"keyword.other.$1.fthtml"},"2":{"name":"keyword.other.$2.fthtml"},"3":{"name":"keyword.other.$3.fthtml"},"4":{"name":"invalid.illegal.keyword-value.fthtml"}}},{"begin":"\\b(js)\\b","beginCaptures":{"1":{"name":"entity.name.tag.fthtml"}},"end":"(?<=\\})","patterns":[{"begin":"\\{","beginCaptures":{"0":{"name":"punctuation.definition.tag.begin.fthtml"}},"end":"\\}","endCaptures":{"0":{"name":"punctuation.definition.tag.end.fthtml"}},"contentName":"meta.embedded.block.js","patterns":[{"include":"source.js"}]}]},{"begin":"\\b(css)\\b","beginCaptures":{"1":{"name":"entity.name.tag.fthtml"}},"end":"(?<=\\})","patterns":[{"begin":"\\{","beginCaptures":{"0":{"name":"punctuation.definition.tag.begin.fthtml"}},"end":"\\}","endCaptures":{"0":{"name":"punctuation.definition.tag.end.fthtml"}},"contentName":"meta.embedded.block.css","patterns":[{"include":"source.css"}]}]}]},"macros":{"patterns":[{"match":"\\b__(UUID|JS_AGENT|JS_URI|JS_URI_HASH|JS_URI_HOSTNAME|JS_URI_HOST|JS_URI_PORT|JS_URI_PATH|JS_URI_PROTOCOL|JS_URI_SEARCH)__\\b","captures":{"0":{"name":"meta.macro.fthtml constant.language.__$1__.fthtml"}}},{"match":"\\b__((?:JS_)?(?:DATE|DATETIME|ISO_DATE|LOCAL_DATE|LOCAL_DATETIME|NOW))__\\b","captures":{"0":{"name":" meta.macro.fthtml constant.language.__$1__.fthtml"}}}]},"functions":{"patterns":[{"begin":"\\b(addslashes|choose|html_encode|html_decode|random|replace|str_repeat|str_reverse|str_format|substring|tcase|trim|len|str_split|join)(\\()","beginCaptures":{"1":{"name":"support.function.fthtml meta.function.fthtml meta.function.$1.fthtml entity.name.function.fthtml"},"2":{"name":"meta.parameters.fthtml punctuation.definition.parameters.begin.fthtml"}},"end":"\\)","endCaptures":{"0":{"name":"meta.parameters.fthtml punctuation.definition.parameters.end.fthtml"}},"patterns":[{"include":"#functions"},{"include":"#macros"},{"include":"#strings"},{"include":"#constants"},{"include":"#variables-ref"},{"include":"#invalid-if-word-is-keyword"},{"include":"#invalid-if-word-is-operator"}]}]},"variables-ref":{"patterns":[{"match":"\\B(@)[\\w-]+","captures":{"0":{"name":"variable.other.fthtml"},"1":{"name":"punctuation.definition.variable.other.begin.fthtml"}}}]},"directives":{"patterns":[{"begin":"(?x)  ^[\\s]*(\\#)(if|elif) # beginning if block\n  [ \\t]+(((?:[^\\)]+\\))+\\)|[^\\)]+\\)|(['\"])[^\\5]*\\5|.*?)[ \\t]+([a-zA-Z]+)[ \\t]+(.*?))[ \\t]*$ #index 3 - meta.expression","beginCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"},"3":{"name":"meta.expression.fthtml"},"4":{"patterns":[{"include":"#arg-types"}]},"6":{"patterns":[{"include":"#operators"},{"include":"#invalid"}]},"7":{"patterns":[{"include":"#arg-types"}]}},"end":"^[\\s]*(\\#)(end)[ \\t]*(?:$|(.*))","endCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"patterns":[{"include":"$self"},{"include":"#child-elements"}]},{"begin":"^[ \\t]*(\\#)(else)[ \\t]*(?:$|(.*))","beginCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"end":"^[\\s]*(\\#)(end)[ \\t]*(?:$|(.*))","endCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"patterns":[{"include":"$self"},{"include":"#child-elements"}]},{"begin":"^[ \\t]*(\\#)(ifdef)[ \\t]*([\\w-]+)[ \\t]*(?:$|(.*))","beginCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"},"3":{"name":"meta.argument.word.fthtml variable.other.constant.fthtml","patterns":[{"include":"#invalid-if-word-is-keyword"}]},"4":{"name":"invalid.illegal.directive-end.fthtml"}},"end":"^[\\s]*(\\#)(end)[ \\t]*(?:$|(.*))","endCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"patterns":[{"include":"$self"},{"include":"#child-elements"}]},{"begin":"^[ \\t]*(\\#)(debug)[ \\t]+","beginCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"}},"end":"$","patterns":[{"include":"#variables-ref"},{"include":"#functions"},{"match":"(['\"])[ \\t]*(\\$)[ \\t]*\\1","captures":{"0":{"name":"string.quoted.fthtml"},"2":{"name":"support.constant.fthtml markup.bold.fthtml"}}},{"include":"#strings"},{"include":"#constants"}]},{"begin":"^[ \\t]*(#)(vars)[ \\t]*(?:$|(.*))","beginCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"end":"^[ \\t]*(#)(end)[ \\t]*(?:$|(.*))","endCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.end.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"patterns":[{"match":"^\\s*([\\w-]+)\\s+(json)\\s*(\\()\\s*((['\"])[^\\5]*\\5)\\s*(\\))\\s*$","captures":{"1":{"name":"variable.other.readwrite.fthtml"},"2":{"name":"meta.function.fthtml meta.function.$2.fthtml entity.name.function.fthtml"},"3":{"name":"meta.parameters.fthtml punctuation.definition.parameters.begin.fthtml"},"4":{"patterns":[{"include":"#string-json"}]},"6":{"name":"meta.parameters.fthtml punctuation.definition.parameters.end.fthtml"}}},{"begin":"^\\s*","end":"$","patterns":[{"include":"#invalid-if-word-any-reserved-word"},{"include":"#comments"},{"begin":"([\\w-]+)\\s+","beginCaptures":{"1":{"name":"variable.other.readwrite.fthtml"}},"end":"(?=\\s*(?:\\/\\/.*)?$)","patterns":[{"include":"#strings"},{"include":"#comments"},{"include":"#macros"},{"include":"#functions"},{"include":"#variables-ref"},{"begin":"(?=\\{)","end":"(?<=\\})","patterns":[{"include":"#fthtmlblock"}]},{"include":"#invalid"}]}]}]},{"begin":"^[ \\t]*(#)(templates|tinytemplates)[ \\t]*(?:$|(.*))","beginCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.$2.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"end":"^[ \\t]*(#)(end)[ \\t]*(?:$|(.*))","endCaptures":{"0":{"name":"keyword.control.directive.fthtml"},"1":{"name":"punctuation.definition.preprocessor.fthtml"},"2":{"name":"meta.keyword.control.directive.end.fthtml"},"3":{"name":"invalid.illegal.directive-end.fthtml"}},"patterns":[{"begin":"^\\s*","end":"$","patterns":[{"include":"#invalid-if-word-any-reserved-word"},{"include":"#comments"},{"begin":"([\\w-]+)\\s+","beginCaptures":{"1":{"name":"variable.other.readwrite.fthtml"}},"end":"(?=\\s*(?:\\/\\/.*)?$)","patterns":[{"include":"#invalid-if-word-any-reserved-word"},{"include":"#entity-with-attr"},{"include":"#strings"},{"match":"([\\w-]+)","name":"entity.name.tag.fthtml"}]}]}]},{"match":"\\#.*","name":"invalid.illegal.directive.fthtml"}]},"operators":{"patterns":[{"match":"\\b(eq|(i|n)e|(g|l)(t|e)|(i)?contains|(i)?starts|(i)?ends|(i)?match)\\b","captures":{"0":{"name":"keyword.operator.$1.fthtml markup.italic.fthtml"}}}]},"constants":{"patterns":[{"include":"#invalid-if-word-is-keyword"},{"match":"\\b\\d+\\b","captures":{"0":{"name":"meta.argument.numeric.fthtml constant.numeric.fthtml"}}},{"match":"([\\w-]+)","captures":{"1":{"name":"meta.argument.word.fthtml variable.other.constant.fthtml"}}}]},"arg-types":{"patterns":[{"include":"#strings"},{"include":"#macros"},{"include":"#functions"},{"include":"#constants"},{"include":"#variables-ref"},{"include":"#invalid"}]},"entity-with-attr":{"patterns":[{"match":"json","name":"invalid.illegal.entity.fthtml"},{"begin":"(?x)  (?!addslashes|choose|html_encode|html_decode|random|replace|str_repeat|str_reverse|str_format|substring|tcase|trim|len|str_split|join|comment|import|doctype|if|elif|else|vars|ifdef|debug|end)([\\w-]+)\\s* #valid identifier\n  (\\() #begin with '(' open","beginCaptures":{"1":{"name":"entity.name.tag.fthtml"},"3":{"name":"punctuation.definition.entity.other.attribute-group.begin.fthtml"}},"end":"(?=(\\)))","endCaptures":{"1":{"name":"punctuation.definition.entity.other.attribute-group.end.fthtml"}},"patterns":[{"name":"entity.other.attribute-name.class.fthtml","begin":"\\B(\\.)(?=@?[\\w-]+|(.*))","beginCaptures":{"1":{"name":"punctuation.entity.other.attribute-name.class.begin.fthtml"},"2":{"name":"invalid.illegal.attribute.class.fthtml"}},"end":"(@?[\\w-]+)(?:\\s|(?=\\))|(.*))","endCaptures":{"1":{"patterns":[{"include":"#variables-ref"}]},"2":{"name":"invalid.illegal.attribute.class.fthtml"}}},{"name":"entity.other.attribute-name.id.fthtml","begin":"\\B(\\#)(?=[\\w-]+|(.*))","beginCaptures":{"1":{"name":"punctuation.entity.other.attribute-name.id.begin.fthtml"},"2":{"name":"invalid.illegal.attribute.id.fthtml"}},"end":"(@?[\\w-]+)(?:\\s|(?=\\))|(.*))","endCaptures":{"1":{"patterns":[{"include":"#variables-ref"}]},"2":{"name":"invalid.illegal.attribute.id.fthtml"}}},{"begin":"([\\w-]+)\\s*(=)\\s*","beginCaptures":{"1":{"name":"entity.other.attribute-name.fthtml"},"2":{"name":"punctuation.separator.key-value.fthtml"}},"end":"\\s|(?=\\))","patterns":[{"include":"#strings"},{"include":"#variables-ref"},{"include":"#macros"},{"name":"string.unquoted.fthtml","match":"(?x) \\s*?([\\w-]+[\\w\\.-]*) #this makes sure that unquoted values are valid with many periods (ex: www.example.com) ([^\\s\\)]*) #followed by anything that doesn't terminate the attribute group because we do it in parent regex end","captures":{"2":{"name":"invalid.illegal.attribute.value.fthtml"}}},{"name":"invalid.illegal.attribute.value.fthtml","match":"\\s*?(?!\\))([\\W].*)"}]},{"include":"#variables-ref"},{"name":"entity.other.attribute-name.fthtml","match":"(?:[\\w-]+)"}]}]},"entities":{"patterns":[{"include":"#strings"},{"include":"#macros"},{"include":"#entity-with-attr"},{"match":"(?!addslashes|choose|html_encode|html_decode|random|replace|str_repeat|str_reverse|str_format|substring|tcase|trim|len|str_split|join|comment|import|doctype|if|elif|else|vars|ifdef|debug|end)([\\w-]+)","captures":{"1":{"name":"entity.name.tag.fthtml"}}}]},"invalid":{"patterns":[{"match":".*","name":"invalid.illegal.fthtml"}]},"invalid-if-word-is-operator":{"patterns":[{"match":"\\b(eq|(i|n)e|(g|l)(t|e)|(i)?contains|(i)?starts|(i)?ends|(i)?match)\\b","name":"invalid.illegal.fthtml"}]},"invalid-if-word-is-keyword":{"patterns":[{"match":"\\b(comment|doctype|import|\\#?(if|el(if|se)|end|vars|debug|(tiny)?templates))\\b","name":"invalid.illegal.fthtml"}]},"invalid-if-word-is-elang":{"patterns":[{"match":"\\b(js|css)\\b","name":"invalid.illegal.fthtml"}]},"invalid-if-word-is-macro":{"patterns":[{"match":"__(UUID|JS_AGENT|JS_URI|JS_URI_HASH|JS_URI_HOSTNAME|JS_URI_HOST|JS_URI_PORT|JS_URI_PATH|JS_URI_PROTOCOL|JS_URI_SEARCH|((?:JS_)?(?:DATE|DATETIME|ISO_DATE|LOCAL_DATE|LOCAL_DATETIME|NOW)))__","name":"invalid.illegal.fthtml"}]},"invalid-if-word-is-function":{"patterns":[{"match":"\\b(addslashes|choose|html_encode|html_decode|random|replace|str_repeat|str_reverse|str_format|substring|tcase|trim|len|str_split|join)\\b","name":"invalid.illegal.fthtml"}]},"invalid-if-word-any-reserved-word":{"patterns":[{"include":"#invalid-if-word-is-keyword"},{"include":"#invalid-if-word-is-macro"},{"include":"#invalid-if-word-is-elang"},{"include":"#invalid-if-word-is-function"},{"include":"#invalid-if-word-is-operator"}]}}}
